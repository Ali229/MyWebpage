<h1>Movies</h1>
<form>
  <div class="row toprow">
    <div class="col-auto">
      <div class="md-form">
        <input mdbInput type="text" id="mname" class="form-control" [(ngModel)]="moviename" name="movname">
        <label for="mname">Title</label>
      </div>
    </div>
    <div class="col-auto">
      <div class="md-form">
        <input mdbInput type="text" id="myear" class="form-control" [(ngModel)]="movieyear" name="movyear">
        <label for="myear">Year</label>
      </div>
    </div>
    <div class="col-auto">
      <div class="md-form">
        <select name="sel" class="browser-default custom-select" [(ngModel)]="selectedOption">
          <option value="">All</option>
          <option value="movie">Movie</option>
          <option value="series">TV</option>
        </select>
      </div>
    </div>
    <div class="col-auto">
      <div class="md-form">
        <button type="submit" (click)="search(moviename,movieyear,selectedOption)" mdbBtn color="elegant" mdbWavesEffect
                id="sub" [disabled]="moviename.length == 0" size="md"> Search
        </button>
      </div>
    </div>
    <div class="col-auto ml-auto">
      <div class="md-form">
        <app-user-profile></app-user-profile>
      </div>
    </div>
  </div>
</form>
<div id="target"></div>
<div style="text-align: center;">
  <span *ngIf="loading" class="spinner-border" style="width: 8rem; height: 8rem;" role="status"></span>
</div>
<div *ngIf="data" [hidden]="loading" class="mt-2">
  <div *ngIf="data.Response != 'False' else elseBlock">
    <div class="row ml-md-3">
      <div class="col-12 col-md-4 animated zoomIn text-light">
        <div class="row">
          <img *ngIf="data.Poster != 'N/A'" class="poster"
               src="{{data.Poster}}" alt="Can't load image">
          <img *ngIf="data.Poster == 'N/A'" class="poster"
               src="assets/404PosterNotFound.jpg" alt="Can't load image">
        </div>
        <div class="row poster-buttons z-depth-3">
          <div class="col-auto p-0">
            <div class="watchlist" (click)="addToWatchlist()">
              <i class="fas fa-bookmark"></i> Watchlist
            </div>
          </div>
          <div class="col-auto ml-auto p-0">
            <div class="love">
              <i class="fas fa-heart"></i>
            </div>
          </div>
          <div class="col-auto p-0">
            <div class="trailer">
              <i class="fas fa-play"></i>
            </div>
          </div>
        </div>
        <app-stream></app-stream>
      </div>
      <div class="col-12 col-md-8 bodyText">
        <div class="ml-1 ml-md-3 mt-2 mt-md-0">
          <div class="row">
            <h2><b>{{data.Title}} <span class="year text-muted">({{data.Year}})</span></b></h2>
          </div>
          <div class="row">
          <span *ngIf="data.Rated != 'N/A'">{{data.Rated}}
            <span class="text-muted">|&nbsp;</span></span>
            <span *ngIf="data.Released != 'N/A'">{{data.Released}}
              <span class="text-muted">|&nbsp;</span></span>
            <span *ngIf="data.Runtime != 'N/A'">{{data.Runtime}}
              <span class="text-muted">|&nbsp;</span></span>
            <span *ngIf="data.Genre != 'N/A'">{{data.Genre}}
              <span class="text-muted">|&nbsp;</span></span>
            <span *ngIf="data.Language != 'N/A'">{{data.Language}}</span>
          </div>
          <div class="row">
            <div *ngIf="data.Plot != 'N/A'">
              <h3 class="mt-4"><b>Plot</b></h3>
              <div>{{data.Plot}}</div>
            </div>
          </div>
          <div class="row">
            <div *ngIf="data.Awards != 'N/A'">
              <h3 class="mt-4"><b>Awards</b></h3>
              <div>{{data.Awards}}</div>
            </div>
          </div>
          <div class="row">
            <h3 *ngIf="data.Ratings.length !== 0 || tmdbScore > 0" class="mt-4"><b>Ratings</b></h3>
            <table class="ratings" mdbTable borderless="true">
              <tbody>
              <tr *ngIf="tmdbScore > 0">
                <td><img class="icon" src="assets/tmdb.png" alt="Can't load image"></td>
                <td><span class="badge badge-{{tmdbColor}} animated zoomIn z-depth-3"
                >{{tmdbScore}}</span></td>
              </tr>
              <tr *ngIf="data.Metascore != 'N/A'">
                <td><img class="icon" src="assets/meta.png" alt="Can't load image"></td>
                <td><span class="badge badge-{{metaColor}} animated zoomIn z-depth-3"
                >{{data.Metascore}}</span></td>
              </tr>
              <tr *ngIf="data.imdbRating != 'N/A'">
                <td><img class="icon" src="assets/imdb.jpg" alt="Can't load image"
                         style="border-radius: 15px;"></td>
                <td><span class="badge badge-{{imdbColor}} animated zoomIn z-depth-3"
                >{{data.imdbRating}}</span></td>
              </tr>
              <tr>
              <tr *ngIf="rottenScore !=  null">
                <td><img class="icon" src="assets/{{rottenImage}}" alt="Can't load image"
                         style="border-radius: 15px;"></td>
                <td><span class="badge badge-{{rottenColor}} animated zoomIn z-depth-3"
                >{{rottenScore}}</span></td>
              </tr>
              <tr *ngIf="totalScore !=  0 && scoreCount > 1">
                <td><img class="icon" src="assets/avg.png" alt="Can't load image"
                         style="border-radius: 15px;"></td>
                <td><span class="badge badge-{{totalColor}} animated zoomIn z-depth-3"
                >{{overallScore}}</span></td>
              </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>
  <ng-template #elseBlock>
    <div class="alert alert-danger" role="alert">
      No results for {{searchedTitle}}!
    </div>
  </ng-template>
</div>
<h2 class="mb-3 mt-3"><b><span style="color:#3F729B; font-size: 130%; border-radius:10px">|</span> Popular Movies</b>
</h2>
<nav class="nav nav-pills nav-justified unique-color">
  <a class="nav-item text-light" (click)="toggleYear(year.key)" *ngFor="let year of popularYears | keyvalue"
     [ngClass]="{'unique-color-dark':year.value}">
    {{year.key.substring(1)}}
  </a>
</nav>
<div class="tab-content" id="pills-tabContent" *ngFor="let year of popularYears | keyvalue" (click)="scrollToElement()">
  <div class="tab-pane fade show active" [ngClass]="{'show active':year.value}">
    <app-popular
      [popList]=popularMovies[year.key.substring(0,1)]></app-popular>
  </div>
</div>
